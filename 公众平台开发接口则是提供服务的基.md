
公众平台开发接口则是提供服务的基础，开发者在公众平台网站中创建公众号、获取接口权限
每个用户针对每个公众号会产生一个安全的OpenID
在申请到认证公众号之前，你可以先通过测试号申请系统，快速申请一个接口测试号，立即开始接口测试开发。 
在开发过程中，可以使用接口调试工具来在线调试某些接口。
开发出现问题时，可以通过接口调用的返回码，以及报警排查指引（在公众平台官网-开发者中心处可以设置接口报警）
公众平台以access_token为接口调用凭据，来调用接口，所有接口的调用需要先获取access_token，access_token在2小时内有效，过期需要重新获取，但1天内获取次数有限，开发者需自行存储，详见获取接口调用凭据（access_token）文档。


第一步 先去申请一个测试号，在微信公众平台申请一个就可以了
第二步 去弄一个花生壳账号搞一个域名 进行内网穿透
第三步 在测试号的管理系统
      1.网页服务	网页帐号	网页授权获取用户基本信息   ----配置回调域名
			2.授权回调页面域名:
			用户在网页授权页同意授权给公众号后，微信会将授权数据传给一个回调页面，回调页面需在此域名下，以确保安全可靠。
			沙盒号回调地址支持域名和ip，正式公众号回调地址只支持域名。
			
			
			
1）网页授权分为两种：
一种为只获取openid (基本授权 snsapi_base)
一种为获取用户全部信息，仅限账户、昵称以及头像等信息 (高级授权 snsapi_userinfo)
（2）你的公众号必须为认证的订阅号或者认证的服务号或申请官方提供的测试号，否则没有此接口权限。

（3）你要配置好回调域名：即用户点击网址获取用户信息后打开哪个域名。



NATAPP申请域名
NATAPP 启动服务  http://ed13eabd20b55077.natappfree.cc -> 127.0.0.1:80  
建立 nginx web服务 默认端口 80  http://127.0.0.1 
nginx收到80端口的请求后，再把请求转发到webpack的服务(默认是8080端口)。这样就能够实现本地开发，下文会具体介绍。
cd /Users/sunzehao/Downloads/安装包
 ./natapp -authtoken=b5dc0cb07f6cb823
 
 
 重启nginx
 sudo nginx -s reload
 编辑nginx 配置
 vim /usr/local/etc/nginx/nginx.conf
 
 mock服务 
 http://ed13eabd20b55077.natappfree.cc/api/
 并且nginx 添加监听6188端口的 代理指向  http://localhost:3999 的mock服务
 

网页帐号	网页授权获取用户基本信息  
1.配置域名不能带协议  127.0.0.1:6188  或域名访问 mfb9vc.natappfree.cc  也不能带路径 如 127.0.0.1:6188/index/index
2.不能加参数


需要优化的内容 
1.nginx 静态资源缓存  源码安装
2.微信sdk 分享和支付 需要正式的认证公众号 appid
3.点击支付按钮 调用/questions/getUserPayAmount 接口记录支付次数（只要点过就调用，异步触发即可）
 需要付款金额 /questions/getUserPayAmount
		参数说明 
			questionsId 题库id 
{
    "code": 200,
    "message": "操作成功",
    "data": {
        "payAmount": "9.9" //需要付款金额
    }
}

4.研究一下hash 和  history 俩种路由模式
	1.hash模式有个好处 页面切换路由时 调用wxsdk不用重新初始化    
	2.history  页面切换路由时  需要重新初始化wxsdk 很麻烦
	3.hash 和  history区别
		1. hash 模式下，仅 hash 符号之前的内容会被包含在请求中，如 http://www.abc.com，因此对于后端来说，即使没有做到对路由的全覆盖，也不会返回 404 错误。
		2.history 模式下，前端的 URL 必须和实际向后端发起请求的 URL 一致，如 http://www.abc.com/book/id。如果后端缺少对 /book/id 的路由处理，将返回 404 错误。V

当从浏览器回车或F5刷新 带有#号的路由时相当于重新向服务器发送请求

5.如果全局接口数据在刷新路由时丢失  
	 1.当前带#的路由url浏览器内回车或F5刷新 全局vuex $store会丢失 
   2 ...刷新页面时全局数据被清空了
	 3.看时候能在vuex初始化时将全局接口请求
	 4.或者是否需要在每个页面都请求全局接口
	 5.终极解决方案 将数据存入seesionstorage中 页面关闭时自动清空了
	   1.浏览器窗口关闭sessionStorage时才会清空
		 2.刷新之类的操作不会清空
	 6.如果分享某一个页面的链接给其他人 那当前路由的seesionstorage会取不到 
	   这时 判断是否存在seesionstorage 没有则跳转至首页
	 7.SessionStorage 和 LocalStorage
	   https://blog.csdn.net/gulang03/article/details/88210979
		 https://www.kancloud.cn/xiaoxiaoqc/web/137937
		 
6.本地调试时 网页授权登录回调页 跨域的问题可能是由于不是认证公众号 ，并且认证公众号内未配置js安全域名等信息

7.认证公众号 js安全域名  业务域名（网页授权域名） 配置
1.这里必须要有注册域名和购买空间（存放校验文件），DNS配置好，且域名得过备案（也就是花生壳之类的无效）。
2.当以上已解决，再去该页面进行安全域名登记，然后你本机host该域名，手机通过本机访问即可。
本机host配置备案域名